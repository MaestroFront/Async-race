(()=>{"use strict";var e,t=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((r=r.apply(e,t||[])).next())}))};const n=(e,t)=>{const n=document.createElement(e);return n.classList.add(t),n},r=n("div","wrapper"),o=n("div","header"),a=n("div","main"),i=n("div","footer");r.append(o,a,i),null===(e=document.querySelector(".body"))||void 0===e||e.append(r);const c={cars:[],newCar:{name:"",color:""},editCar:{name:"",color:""},startCars:[],newWinner:{},winners:[]},s=(e,t,r)=>{const o=n(e,t);return o.classList.add("input"),o.type=r,o},l=(e,t,r)=>{const o=n(e,t);return o.classList.add("button"),o.type=r,o};class d{constructor(e){this.container=a,this.container.id=e}render(){return this.container}}const u=()=>t(void 0,void 0,void 0,(function*(){return fetch("http://127.0.0.1:3000/garage",{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((e=>c.cars=w(c.cars.flat().concat(e),7)))})),g=()=>{c.newCar.name="",c.newCar.color="",c.newWinner.id=0,c.newWinner.wins=0,c.newWinner.time=0,document.querySelector(".create-input").value="",document.querySelector(".create-color").value=m(),document.querySelector(".update-input").value="",document.querySelector(".update-color").value=m()},m=()=>`#${Math.round(1e5+9e5*Math.random())}`;const p=(e,n)=>t(void 0,void 0,void 0,(function*(){return fetch(`http://127.0.0.1:3000/engine?id=${e}&status=${n}`,{method:"PATCH",body:JSON.stringify(c.cars)}).then((e=>e.json())).then((e=>{c.startCars.push(+(e.distance/1e3/2/e.velocity).toFixed(2))}))})),h=(e,n)=>t(void 0,void 0,void 0,(function*(){document.querySelectorAll(".car").forEach(((t,r)=>{+t.id===e&&("started"===n?(t.style.transform=`translateX(${window.innerWidth-250}px)`,t.style.transition=`all ${c.startCars[r]}s ease-in-out`):"stopped"===n&&(t.style.transform="translateX(0px)",t.style.transition="all 1s ease-in-out"))}))})),w=(e,t)=>{const n=[];for(let r=0;r<Math.ceil(e.length/t);r++)n[r]=e.slice(r*t,r*t+t);return n},v=(e,t)=>{const n=[];for(let r=0;r<Math.ceil(e.length/t);r++)n[r]=e.slice(r*t,r*t+t);return n};var S=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((r=r.apply(e,t||[])).next())}))};const f=()=>{const e=n("li","winners-title"),t=n("img","arrow");t.src="../../assets/icons/arrow.svg";const r=s("input","winners-number","text");r.value="Number",r.readOnly=!0;const o=s("input","winners-car","text");o.value="Car",o.readOnly=!0;const a=s("input","winners-name","text");a.value="Name",a.readOnly=!0;const i=s("input","winners-wins","text");i.value="Wins",i.readOnly=!0,i.onclick=()=>{b(t,"sortWins","sortTime",".winners-wins",y)};const c=s("input","winners-best-time","text");return c.value="Best Time(s)",c.readOnly=!0,c.onclick=()=>{b(t,"sortTime","sortWins",".winners-best-time",x)},e.append(r,o,a,i,c),e},b=(e,t,n,r,o)=>{var a,i,c;localStorage.setItem(n,"default"),"default"===localStorage.getItem(t)?(o(),localStorage.setItem(t,"increase"),null===(a=document.querySelector(".arrow"))||void 0===a||a.remove()):"increase"===localStorage.getItem(t)?(o(),localStorage.setItem(t,"decrease"),e.style.transform="rotate(180deg)",null===(i=document.querySelector(r))||void 0===i||i.after(e)):"decrease"===localStorage.getItem(t)&&(o(),localStorage.setItem(t,"default"),e.style.transform="rotate(0deg)",null===(c=document.querySelector(r))||void 0===c||c.after(e))},y=()=>{const e=localStorage.getItem("sortWins");"increase"===e&&(c.winners=v(c.winners.flat().sort(((e,t)=>t.wins-e.wins)),10)),"default"===e&&(c.winners=v(c.winners.flat(),10)),"decrease"===e&&(c.winners=v(c.winners.flat().sort(((e,t)=>e.wins-t.wins)),10)),c.winners[+localStorage.getItem("currentWinPage")-1].forEach((e=>{document.querySelector(".winners-table").innerHTML="",document.querySelector(".winners-table").append(f()),setTimeout((()=>{P(e.id,e.wins,e.name,e.color,e.time)}),100)}))},x=()=>{const e=localStorage.getItem("sortTime");"increase"===e?c.winners=v(c.winners.flat().sort(((e,t)=>t.time-e.time)),10):"decrease"===e&&(c.winners=v(c.winners.flat().sort(((e,t)=>e.time-t.time)),10)),c.winners[+localStorage.getItem("currentWinPage")-1].forEach((e=>{document.querySelector(".winners-table").innerHTML="",document.querySelector(".winners-table").append(f()),setTimeout((()=>{P(e.id,e.wins,e.name,e.color,e.time)}),100)}))},C=()=>S(void 0,void 0,void 0,(function*(){return fetch("http://127.0.0.1:3000/winners",{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((e=>{c.winners=v(e,10)}))})),I=e=>S(void 0,void 0,void 0,(function*(){return fetch(`http://127.0.0.1:3000/winners/${e}`,{method:"PUT",body:JSON.stringify(c.newWinner),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>e))})),P=(e,t,r,o,a)=>S(void 0,void 0,void 0,(function*(){yield C(),document.querySelector(".winners-table").append(((e,t,r,o,a)=>{const i=n("li","car-winner"),s=n("span","car-winner-number");c.winners.flat().forEach(((t,n)=>{t.id===e&&(s.textContent=`${n+1}`)}));const l=$(e);l.style.width="50px",l.setAttributeNS(null,"fill",o);const d=n("span","car-winner-name");d.textContent=t;const u=n("span","car-winner-wins");localStorage.getItem(`Winners_${e}`)?u.textContent=localStorage.getItem(`Winners_${e}`):u.textContent=`${r}`;const g=n("span","car-winner-best-time");return g.textContent=`${a}`,i.append(s,l,d,u,g),i})(e,r,t,o,a))}));class q extends d{constructor(e){super(e),this.container=(()=>{const e=n("div","winners-page"),t=n("p","winners-text");t.textContent="Winners ";const r=n("span","winners-quantity");r.textContent=`(${c.winners.flat().length})`;const o=n("p","current-win-page-text");o.textContent="Page ";const a=n("span","current-win-page");return a.textContent=`${localStorage.getItem("currentWinPage")}`,o.append(a),t.append(r),e.append(t,o,(()=>{const e=n("ul","winners-table");return e.append(f()),e})(),(()=>{const e=n("div","winners-btns-container"),t=l("button","btn-prev-win","button");t.textContent="prev",t.onclick=()=>{localStorage.setItem("currentWinPage",String(+localStorage.getItem("currentWinPage")-1)),document.querySelector(".current-win-page").textContent=localStorage.getItem("currentWinPage"),c.winners[+localStorage.getItem("currentWinPage")-1].forEach((e=>{document.querySelector(".winners-table").innerHTML="",document.querySelector(".winners-table").append(f()),setTimeout((()=>{P(e.id,e.wins,e.name,e.color,e.time)}),100)})),r.disabled=!1,"1"===localStorage.getItem("currentWinPage")&&(t.disabled=!0)};const r=l("button","btn-next-win","button");return r.textContent="next",r.onclick=()=>{localStorage.setItem("currentWinPage",String(+localStorage.getItem("currentWinPage")+1)),document.querySelector(".current-win-page").textContent=localStorage.getItem("currentWinPage"),c.winners[+localStorage.getItem("currentWinPage")-1].forEach((e=>{document.querySelector(".winners-table").innerHTML="",document.querySelector(".winners-table").append(f()),setTimeout((()=>{P(e.id,e.wins,e.name,e.color,e.time)}),100)})),t.disabled=!1,localStorage.getItem("currentWinPage")===String(c.winners.length)&&(r.disabled=!0)},"1"===localStorage.getItem("currentWinPage")&&(t.disabled=!0),e.append(t,r),e})()),e})()}render(){return this.container}}var W=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((r=r.apply(e,t||[])).next())}))};const E=()=>{const e=n("div","settings-btn__container"),r=l("button","btn-race","button");r.textContent="Race",r.onclick=()=>W(void 0,void 0,void 0,(function*(){document.querySelector(".btn-generate").disabled=!0,r.disabled=!0,yield t(void 0,void 0,void 0,(function*(){const e=document.querySelectorAll(".car");yield Promise.all(Array.from(e).map((e=>t(void 0,void 0,void 0,(function*(){yield p(+e.id,"started")}))))),e.forEach(((e,n)=>{(e=>{t(void 0,void 0,void 0,(function*(){return fetch(`http://127.0.0.1:3000/engine?id=${e.id}&status=drive`,{method:"PATCH",body:JSON.stringify(c.cars)}).then((t=>{if(500===t.status){const t=Math.floor(e.getBoundingClientRect().x)-80;e.style.transform=`translate(${t}px)`,c.cars[+localStorage.getItem("currentPage")-1].forEach(((t,n)=>{t.id===+e.id&&c.startCars.splice(n,1,100)}))}}))}))})(e),e.style.transform=`translateX(${window.innerWidth-250}px)`,e.style.transition=`all ${c.startCars[n]}s ease-in-out`})),setTimeout((()=>{const e=Math.min.apply(null,c.startCars),t=c.cars[+localStorage.getItem("currentPage")-1][c.startCars.indexOf(e)],n=document.querySelector(".popup-winner");n.style.transform="translateX(-50%) scale(1)",n.style.opacity="1",0===c.startCars.filter((e=>100!==e)).length?n.textContent="NOBODY wins!":n.textContent=`${t.name} win with time: ${e} seconds!`,localStorage.getItem(`Winners_${t.id}`)?localStorage.setItem(`Winners_${t.id}`,String(+localStorage.getItem(`Winners_${t.id}`)+1)):localStorage.setItem(`Winners_${t.id}`,"1"),c.newWinner={id:+t.id,wins:+localStorage.getItem(`Winners_${t.id}`),time:e,name:t.name,color:t.color},setTimeout((()=>{n.style.transform="scale(0)",n.style.opacity="0"}),3e3)}),5e3)})),setTimeout((()=>W(void 0,void 0,void 0,(function*(){S(void 0,void 0,void 0,(function*(){const e=c.newWinner.id;if(!c.winners.flat().map((e=>e.id)).includes(e))return fetch("http://127.0.0.1:3000/winners",{method:"POST",body:JSON.stringify(c.newWinner),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>(500===e.status&&c.winners.flat().forEach((e=>{if(e.id===c.newWinner.id){const t=c.newWinner.time;e.time>t&&I(e.id)}})),e.json())));I(c.newWinner.id)})),document.querySelector(".btn-reset").disabled=!1,C()}))),11e3)}));const o=l("button","btn-reset","button");o.textContent="Reset",o.disabled=!0,o.onclick=()=>{r.disabled=!1,o.disabled=!0,document.querySelector(".btn-generate").disabled=!1,t(void 0,void 0,void 0,(function*(){const e=document.querySelectorAll(".car");yield Promise.all(Array.from(e).map((e=>t(void 0,void 0,void 0,(function*(){yield p(+e.id,"stopped")}))))),e.forEach((e=>{e.style.transform="translateX(0px)",e.style.transition="all 1s ease-in-out"})),c.startCars=[]})),g()};const a=l("button","btn-generate","button");return a.textContent="Generate cars",a.onclick=()=>W(void 0,void 0,void 0,(function*(){yield function(){return t(this,void 0,void 0,(function*(){const e=yield fetch("https://cars-base.ru/api/cars"),n=yield e.json(),r=[],o=yield fetch("https://api.sampleapis.com/simpsons/characters"),a=yield o.json();for(let e=0;e<100;e++){const e=Math.round(309*Math.random());r.push({name:`${n[e].id} ${a[e].name.split(" ")[0]}`,color:m()})}r.forEach((e=>t(this,void 0,void 0,(function*(){return fetch("http://127.0.0.1:3000/garage",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((e=>{c.cars=w(c.cars.flat().concat(e),7)}))}))))}))}(),setTimeout((()=>{L(c.cars),T(),document.querySelector(".btn-next").disabled=!1}),500)})),e.append(r,o,a),e},T=()=>{document.querySelector(".cars-quantity").textContent=`(${c.cars.flat().length})`},$=e=>{const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.id=`${e}`,n.classList.add("car"),n.setAttributeNS(null,"version","1.0"),n.setAttributeNS(null,"width","100"),n.setAttributeNS(null,"viewBox","0 0 1280.000000 640.000000"),n.setAttributeNS(null,"preserveAspectRatio","xMidYMid meet");const r=document.createElementNS(t,"g");r.setAttribute("transform","translate(0.000000,640.000000) scale(0.100000,-0.100000)"),r.setAttribute("stroke","none");const o=document.createElementNS(t,"path");return o.setAttribute("d","M4235 5299 c-187 -12 -354 -28 -555 -55 -671 -89 -859 -155 -2007 -705 l-392 -188 -438 -56 c-241 -31 -455 -61 -475 -66 -88 -23 -148 -157 -183 -409 -16 -117 -35 -427 -35 -595 l-1 -110 -32 -20 c-39 -25 -71 -80 -91 -159 -14 -57 -13 -77 9 -296 l24 -235 -30 -43 -31 -42 22 -45 c27 -57 125 -148 239 -223 l90 -59 273 -37 c150 -21 462 -65 693 -98 231 -34 471 -64 534 -67 l115 -6 12 -50 c7 -27 36 -96 64 -151 197 -392 691 -578 1190 -448 270 70 495 240 598 454 l47 97 186 -5 185 -5 33 42 33 42 337 -6 c185 -3 838 -10 1451 -15 613 -6 1543 -15 2065 -20 934 -10 952 -10 1065 10 63 11 124 22 135 25 17 3 29 -10 65 -73 53 -90 185 -229 279 -292 270 -181 643 -244 952 -159 235 64 435 219 545 421 l39 72 135 33 c95 23 254 47 540 82 l405 49 216 88 216 87 6 211 c3 126 12 249 22 306 28 157 7 286 -52 313 -15 7 -27 24 -33 51 -45 176 -182 437 -288 548 -144 151 -827 325 -1798 457 -321 44 -655 82 -929 106 l-179 15 -176 104 c-313 186 -695 393 -1067 579 -334 167 -765 368 -843 392 -265 83 -655 134 -1175 155 -288 11 -1831 11 -2010 -1z"),r.append(o),n.append(r),n},N=(e,r)=>{const o=n("li","car-item");o.id=`${r}`;const a=n("div","changing-block"),i=l("button","btn-select","button");i.textContent="Select",i.onclick=()=>{O(r),document.querySelector(".update-button").disabled=!1};const s=l("button","btn-remove","button");s.textContent="Remove",s.onclick=()=>{localStorage.getItem("currentPage")===String(c.cars.length-1)&&(document.querySelector(".btn-next").disabled=!0),localStorage.removeItem(`Winners_${r}`),M(r)};const d=n("span","car-name");d.textContent=e.name,a.append(i,s,d);const u=$(r);u.setAttributeNS(null,"fill",e.color);const g=n("div","move-block"),m=l("button","start-car","button");m.textContent="A",m.id=`${r}`,m.onclick=()=>W(void 0,void 0,void 0,(function*(){setTimeout((()=>W(void 0,void 0,void 0,(function*(){var e;m.disabled=!0,yield p(+m.id,"started"),yield(e=+m.id,t(void 0,void 0,void 0,(function*(){const t=document.querySelectorAll(".car");return h(+e,"started"),fetch(`http://127.0.0.1:3000/engine?id=${e}&status=drive`,{method:"PATCH",body:JSON.stringify(c.cars)}).then((n=>{500===n.status&&t.forEach((t=>{if(t.id===`${e}`){const e=Math.floor(t.getBoundingClientRect().x)-80;t.style.transform=`translate(${e}px)`}}))}))}))),w.disabled=!1}))),200)}));const w=l("button","stop-car","button");w.textContent="B",w.id=`${r}`,w.disabled=!0,w.onclick=()=>W(void 0,void 0,void 0,(function*(){yield p(+w.id,"stopped"),m.disabled=!1,h(+w.id,"stopped"),w.disabled=!0}));const v=n("img","finish-image");return v.src="../../assets/icons/finish.png",g.append(m,w,u,v),o.append(a,g),o},A=n("ul","cars-list"),k=()=>{const e=n("div","garage-page");return e.append((()=>{const e=n("div","settings-container");return e.append((()=>{const e=n("div","create-block"),r=s("input","create-input","text");r.placeholder="edit a name of car",r.addEventListener("change",(e=>{const t=e.target;c.newCar.name=t.value})),r.oninput=()=>{localStorage.setItem("createCarName",r.value),r.value.length>0?a.disabled=!1:a.disabled=!0};const o=s("input","create-color","color");o.addEventListener("change",(e=>{const t=e.target;c.newCar.color=t.value})),o.value=m(),o.oninput=()=>{r.value.length>0?a.disabled=!1:a.disabled=!0};const a=l("button","create-button","button");return a.textContent="Create",a.disabled=!0,a.onclick=()=>W(void 0,void 0,void 0,(function*(){a.disabled=!0,document.querySelector(".create-input").value.length>0&&document.querySelector(".create-color").value.length>0&&(yield t(void 0,void 0,void 0,(function*(){const e=localStorage.getItem("currentPage");return fetch("http://127.0.0.1:3000/garage",{method:"POST",body:JSON.stringify(c.newCar),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((t=>{c.cars[+e-1].length<7?c.cars[+e-1].push(t):c.cars[+e]?c.cars[+e+1].push(t):(c.cars.push([]),c.cars[+e].push(t))}))})),setTimeout((()=>{L(c.cars),g(),T()}),300)),+localStorage.getItem("currentPage")<c.cars.length&&(document.querySelector(".btn-next").disabled=!1)})),e.append(r,o,a),e})(),(()=>{const e=n("div","update-block"),t=s("input","update-input","text");t.placeholder="edit a name of car",t.addEventListener("change",(e=>{const t=e.target;c.editCar.name=t.value})),t.oninput=()=>{t.value.length>0?o.disabled=!1:o.disabled=!0,localStorage.setItem("updateCarName",t.value)};const r=s("input","update-color","color");r.addEventListener("change",(e=>{const t=e.target;c.editCar.color=t.value})),r.value=m();const o=l("button","update-button","button");return o.textContent="Update",o.disabled=!0,o.onclick=()=>W(void 0,void 0,void 0,(function*(){yield fetch(`http://127.0.0.1:3000/garage/${c.editCar.id}`,{method:"PUT",body:JSON.stringify(c.editCar),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((e=>e)),L(c.cars),g(),T(),o.disabled=!0})),e.append(t,r,o),e})(),E()),e})(),(()=>{const e=n("div","current-data"),t=n("p","cars-title");t.textContent="Garage ";const r=n("span","cars-quantity");r.textContent=`(${c.cars.flat().length})`;const o=n("p","page");o.textContent="Page ";const a=n("span","current-page");return a.textContent=`${localStorage.getItem("currentPage")}`,t.append(r),o.append(a),e.append(t,o),e})(),A,(()=>{const e=n("div","switches-block"),t=l("button","btn-prev","button");t.textContent="prev",t.onclick=()=>{localStorage.setItem("currentPage",""+(+localStorage.getItem("currentPage")-1)),document.querySelector(".current-page").textContent=localStorage.getItem("currentPage"),L(c.cars),r.disabled=!1,"1"===localStorage.getItem("currentPage")&&(t.disabled=!0)};const r=l("button","btn-next","button");return r.textContent="next",r.onclick=()=>{localStorage.setItem("currentPage",""+(+localStorage.getItem("currentPage")+1)),document.querySelector(".current-page").textContent=localStorage.getItem("currentPage"),L(c.cars),t.disabled=!1,localStorage.getItem("currentPage")===String(c.cars.length)&&(r.disabled=!0)},"1"===localStorage.getItem("currentPage")&&(t.disabled=!0),e.append(t,r),e})()),e},O=e=>{const t=localStorage.getItem("currentPage");c.cars[+t-1].forEach(((n,r)=>{if(n.id===e){const e=c.cars[+t-1][r];c.editCar=e}})),document.querySelector(".update-input").value=c.editCar.name,document.querySelector(".update-color").value=c.editCar.color},M=e=>W(void 0,void 0,void 0,(function*(){yield j(e),yield C(),c.cars=w(c.cars.flat(),7),c.winners=v(c.winners.flat(),10),L(c.cars),T()})),j=e=>W(void 0,void 0,void 0,(function*(){const t=localStorage.getItem("currentPage");c.cars[+t-1].forEach(((n,r)=>{if(n.id===e){const e=c.cars[+t-1][r];(e=>{fetch(`http://127.0.0.1:3000/garage/${e}`,{method:"DELETE"})})(e.id),(e=>{c.winners.flat().map((e=>e.id)).includes(e)&&fetch(`http://127.0.0.1:3000/winners/${e}`,{method:"DELETE"})})(e.id),c.cars[+t-1].splice(r,1),c.winners.flat().forEach(((t,n)=>{t.id===e.id&&c.winners.flat().splice(n,1)}))}}))})),L=e=>{const t=document.querySelector(".cars-list"),n=localStorage.getItem("currentPage");t.innerHTML="",0===e.length&&(e.push([]),e[+n-1].forEach(((e,r)=>{e.name&&e.color?t.append(N(e,c.cars[+n-1][r].id)):e.name&&(e.color=m(),t.append(N(e,c.cars[+n-1][r].id)))}))),e[+n-1].length&&e[+n-1].forEach(((e,r)=>{e.name&&e.color?t.append(N(e,c.cars[+n-1][r].id)):e.name&&(e.color=m(),t.append(N(e,c.cars[+n-1][r].id)))}))};class G extends d{constructor(e){super(e),this.container=k()}render(){return this.container}}class _ extends class{constructor(){this.container=o}render(){return this.container}}{constructor(){super(),this.container=(()=>{const e=n("div","btn-container"),t=l("button","btn-garage","button");t.textContent="to garage",t.id="garage",t.onclick=()=>{return e=void 0,n=void 0,a=function*(){localStorage.setItem("PAGE","garage"),setTimeout((()=>{localStorage.getItem("currentPage")===String(c.cars.length)&&(document.querySelector(".btn-next").disabled=!0)}),100),r.disabled=!1,t.disabled=!0,c.cars=[],yield u(),yield C(),L(c.cars),localStorage.getItem("currentPage")===String(c.cars.length)&&(document.querySelector(".btn-next").disabled=!0),T(),localStorage.getItem("createCarName")&&(document.querySelector(".create-input").value=localStorage.getItem("createCarName")),localStorage.getItem("createCarName")&&(document.querySelector(".update-input").value=localStorage.getItem("updateCarName"))},new((o=void 0)||(o=Promise))((function(t,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function c(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,c)}s((a=a.apply(e,n||[])).next())}));var e,n,o,a};const r=l("button","btn-winners","button");r.textContent="to winners",r.id="winners",r.onclick=()=>{localStorage.setItem("PAGE","winners"),r.disabled=!0,t.disabled=!1,setTimeout((()=>{0===c.winners.length&&(document.querySelector(".btn-next-win").disabled=!0),1===c.winners.length?c.winners.flat().forEach((e=>{P(e.id,e.wins,e.name,e.color,e.time),+localStorage.getItem("currentWinPage")===c.winners.length&&(document.querySelector(".btn-next-win").disabled=!0)})):c.winners.length>1&&c.winners[+localStorage.getItem("currentWinPage")-1].forEach((e=>{P(e.id,e.wins,e.name,e.color,e.time),+localStorage.getItem("currentWinPage")===c.winners.length&&(document.querySelector(".btn-next-win").disabled=!0)}))}),100)};const o=n("a","to-garage");o.href=`#${t.id}`;const a=n("a","to-winners");return a.href=`#${r.id}`,o.append(t),a.append(r),e.append(o,a,n("div","popup-winner")),e})()}render(){return this.container}}class H extends d{constructor(e){super(e),this.container=(()=>{const e=n("div","error-page"),t=n("p","error-text");return t.textContent="Error 404!!!",e.append(t),e})()}render(){return this.container}}const U=document.querySelector(".main"),J=document.querySelector(".header");class R{static renderNewPage(e){R.container.innerHTML="";let t=null;if(t="garage"===e?new G(e):"winners"===e?new q(e):new H(e),t){const e=t.render();R.container.append(e)}}enableRouteChange(){window.addEventListener("hashchange",(()=>{const e=window.location.hash.slice(1);R.renderNewPage(e)}))}constructor(){this.initialPage=new G("garage"),this.header=new _}run(){R.renderNewPage(localStorage.getItem("PAGE")),J.append(this.header.render()),this.enableRouteChange()}}R.container=U;localStorage.getItem("currentPage")||localStorage.setItem("currentPage","1"),localStorage.getItem("currentWinPage")||localStorage.setItem("currentWinPage","1"),localStorage.getItem("sortWins")||localStorage.setItem("sortWins","default"),localStorage.getItem("sortTime")||localStorage.setItem("sortTime","default"),localStorage.getItem("PAGE")||localStorage.setItem("PAGE","garage"),(new R).run(),window.onload=()=>{return e=void 0,t=void 0,r=function*(){"garage"===localStorage.getItem("PAGE")&&(localStorage.setItem("currentPage",`${document.querySelector(".current-page").textContent}`),yield u(),yield C(),L(c.cars),localStorage.getItem("currentPage")===String(c.cars.length)&&(document.querySelector(".btn-next").disabled=!0),T(),localStorage.getItem("createCarName")&&(document.querySelector(".create-input").value=localStorage.getItem("createCarName")),localStorage.getItem("createCarName")&&(document.querySelector(".update-input").value=localStorage.getItem("updateCarName"))),"winners"===localStorage.getItem("PAGE")&&(localStorage.setItem("PAGE","winners"),document.querySelector(".btn-winners").disabled=!0,document.querySelector(".btn-garage").disabled=!1,yield C(),setTimeout((()=>{0===c.winners.length&&(document.querySelector(".btn-next-win").disabled=!0),1===c.winners.length?c.winners.flat().forEach((e=>{P(e.id,e.wins,e.name,e.color,e.time),+localStorage.getItem("currentWinPage")===c.winners.length&&(document.querySelector(".btn-next-win").disabled=!0)})):c.winners.length>1&&c.winners[+localStorage.getItem("currentWinPage")-1].forEach((e=>{P(e.id,e.wins,e.name,e.color,e.time),+localStorage.getItem("currentWinPage")===c.winners.length&&(document.querySelector(".btn-next-win").disabled=!0)})),document.querySelector(".winners-quantity").textContent=`(${c.winners.flat().length})`}),100))},new((n=void 0)||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((r=r.apply(e,t||[])).next())}));var e,t,n,r}})();